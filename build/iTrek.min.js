!function(t){"use strict";function e(t){return"[object Object]"===Object.prototype.toString.call(t)}function r(t){return Array.prototype.slice.apply(t,Array.prototype.slice.call(arguments,1))}function s(t,e){return(e||document).querySelector(t)}function n(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function o(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("\\s*\\b"+e+"\\b","g"),"")}var i=function(){var t=r(arguments,0,3);if(!t.length)throw new Error("参数错误!");var n=e(t.slice(-1)[0])?t.pop():{};if(n.dom=t[0],!n.dom)throw new Error("容器参数不能为空!");if(this.wrap="string"==typeof n.dom?s(n.dom):n.dom,!this.wrap)throw new Error("找不到对应的容器!");if(!this.wrap.loaded){this.wrap.loaded=!0,this._opts={playClass:"play",index:0,speed:400,triggerDist:30,isVertical:!0,useACC:!0,fullScr:!0,preventMove:!1,isLoop:!1,onslide:function(t){}};for(var o in n)this._opts[o]=n[o];n=null,t=null,this._renderWrapper(),this._bindEvent()}};i.prototype.addEvent=function(t,e,r){document.addEventListener?t.addEventListener(e,r,!1):document.attachEvent?t.attachEvent("on"+e,r):t["on"+e]=r,t["Listener-"+e]=!0},i.prototype._bindEvent=function(){var t=this,e=t._opts,r=e.fullScr?s("body"):t.wrap;r.addEventListener("touchstart",function(e){t._touchstart(e)},!1),r.addEventListener("touchmove",function(r){t._touchmove(r),e.fullScr||(r.stopPropagation(),r.preventDefault())},!1),r.addEventListener("touchend",function(e){t._touchend(e)},!1),r.addEventListener("touchcancel",function(e){t._touchend(e)},!1),(e.fullScr||e.preventMove)&&r.addEventListener("touchmove",function(t){t.preventDefault()},!1)},i.prototype._touchstart=function(t){var e=this,r=e._opts;if(1===t.touches.length){e.lockSlide=!1,e._touchStartX=t.touches[0].pageX,e._touchStartY=t.touches[0].pageY,e.touchInitPos=r.isVertical?t.touches[0].pageY:t.touches[0].pageX,e.trek1=e.touchInitPos,e.startPos=0,e.startPosPrev=-e.scrollDist,e.startPosNext=e.scrollDist;var s="-webkit-transition-duration:0;-moz-transition-duration:0;-ms-transition-duration:0;-o-transition-duration:0;transition-duration:0;";e._next&&(e._next.style.cssText+=s),e._current.style.cssText+=s,e._prev&&(e._prev.style.cssText+=s)}},i.prototype._touchmove=function(t){var e=t.target;do e=e.parentNode;while(e!=this.wrap);if(e||t.target==this.wrap){var r=this,s=r._opts;if(1===t.touches.length&&!r.lockSlide){var n=Math.abs(t.touches[0].pageX-r._touchStartX),o=Math.abs(t.touches[0].pageY-r._touchStartY);if(n>o&&s.isVertical)return void(r.lockSlide=!0);if(o>n&&!s.isVertical)return void(r.lockSlide=!0);var i=s.isVertical?t.touches[0].pageY:t.touches[0].pageX;r.trek2=i-r.trek1,r.totalDist=r.startPos+i-r.touchInitPos,r._current.style.cssText+=r._getTransform(+r.totalDist+"px"),r.startPos=r.totalDist,r.totalDist<0?r._next&&(r.totalDist2=r.startPosNext+i-r.touchInitPos,r._next.style.cssText+=r._getTransform(r.totalDist2+"px"),r.startPosNext=r.totalDist2):r._prev&&(r.totalDist2=r.startPosPrev+i-r.touchInitPos,r._prev.style.cssText+=r._getTransform(r.totalDist2+"px"),r.startPosPrev=r.totalDist2),r.touchInitPos=i}}},i.prototype._touchend=function(t){var e=this,r=e._opts;e.trek2<-r.triggerDist?e.next():e.trek2>r.triggerDist?e.prev():e._itemReset(),e.trek2=0},i.prototype._itemReset=function(){var t=this;t._opts;t._current.style.cssText+=t.getDurationCss(0),t._prev&&(t._prev.style.cssText+=t.getDurationCss("-"+t.scrollDist+"px")),t._next&&(t._next.style.cssText+=t.getDurationCss(+t.scrollDist+"px")),t.trek2=0},i.prototype._renderWrapper=function(){var t=this,e=t._opts;t.index=e.index,t._tpl=t.wrap.cloneNode(!0),t._tpl=e.item?t._tpl.querySelectorAll(e.item):t._tpl.children,t.length=t._tpl.length,t.touchInitPos=0,t.startPos=0,t.totalDist=0,t.trek1=0,t.trek2=0,t._delayTime=150;for(var r=0;r<t.length;r++)t._tpl[r].style.cssText+="display:block;position:absolute;left:0;top:0;width:100%;height:100%";if(e.fullScr){var s=document.createElement("style");s.innerHTML="html,body{width:100%; height:100%; overflow:hidden}",document.head.appendChild(s),s=null}t.wrap.style.cssText+="display:block; position:relative;"+(e.fullScr?"width:100%; height:100%":""),t.displayWidth=t.wrap.clientWidth,t.displayHeight=t.wrap.clientHeight,t.scrollDist=e.isVertical?t.displayHeight:t.displayWidth,t._setHTML(),/iPhone|iPod|iPad/.test(navigator.userAgent)&&(t._delayTime=50)},i.prototype._setHTML=function(t){var e=this,r=e._opts;t&&t>0&&(e.index=+t),e.wrap.innerHTML="";var s=document.createDocumentFragment();e.index>0?(e._prev=e._tpl[e.index-1].cloneNode(!0),e._prev.style.cssText+=e._getTransform("-"+e.scrollDist+"px"),s.appendChild(e._prev)):r.isLoop?(e._prev=e._tpl[e.length-1].cloneNode(!0),e._prev.style.cssText+=e._getTransform("-"+e.scrollDist+"px"),s.appendChild(e._prev)):e._prev=null,e._current=e._tpl[e.index].cloneNode(!0),e._current.style.cssText+=e._getTransform(0),s.appendChild(e._current),e.index<e.length-1?(e._next=e._tpl[e.index+1].cloneNode(!0),e._next.style.cssText+=e._getTransform("+"+e.scrollDist+"px"),s.appendChild(e._next)):e._next=null,e.wrap.appendChild(s)},i.prototype.getDurationCss=function(t,e){return"-webkit-transition-duration:"+(e||this._opts.speed)+"ms;"+this._getTransform(t)+"transition-duration:"+(e||this._opts.speed)+"ms;"+this._getTransform(t)},i.prototype._getTransform=function(t){var e=this._opts.useACC,r=this._opts.isVertical?"0, "+t:t+", 0";return"-webkit-transform:"+(e?"translate3d("+r+", 0);":"translate("+r+");")+"-moz-transform:"+(e?"translate3d("+r+", 0);":"translate("+r+");")+"-ms-transform:"+(e?"translate3d("+r+", 0);":"translate("+r+");")+"-o-transform:"+(e?"translate3d("+r+", 0);":"translate("+r+");")+"transform:"+(e?"translate3d("+r+", 0);":"translate("+r+");")},i.prototype.prev=function(){var t=this,e=t._opts;if(!t._current||!t._prev)return void t._itemReset();if(t.index>0)t.index--;else{if(!e.isLoop||0!==t.index)return t._itemReset(),!1;t.index=t.length-1}t._next&&t.wrap.removeChild(t._next),t._next=t._current,t._current=t._prev,t._prev=null,t._next.style.cssText+=t.getDurationCss(+t.scrollDist+"px"),t._current.style.cssText+=t.getDurationCss(0),setTimeout(function(){s("."+e.playClass,t.wrap)&&o(s("."+e.playClass,t.wrap),e.playClass),n(t._current,e.playClass);try{e.onslide.call(t,t.index)}catch(r){console.info(r)}var i=t.index-1;return 0>i&&(i=t.length-1,!e.isLoop)?!1:(t._prev=t._tpl[i].cloneNode(!0),t._prev.style.cssText+=t.getDurationCss("-"+t.scrollDist+"px",0),void t.wrap.insertBefore(t._prev,t._current))},t._delayTime)},i.prototype.next=function(){var t=this,e=t._opts;if(!t._current||!t._next)return void t._itemReset();if(t.index<t.length-1)t.index++;else{if(t.index!==t.length-1)return t._itemReset(),!1;t.index=0}t._prev&&t.wrap.removeChild(t._prev),t._prev=t._current,t._current=t._next,t._next=null,t._prev.style.cssText+=t.getDurationCss("-"+t.scrollDist+"px"),t._current.style.cssText+=t.getDurationCss(0),setTimeout(function(){s("."+e.playClass,t.wrap)&&o(s("."+e.playClass,t.wrap),e.playClass),n(t._current,e.playClass);try{e.onslide.call(t,t.index)}catch(r){console.info(r)}var i=t.index+1;if(i>=t.length){if(!e.isLoop)return!1;i=0}t._next=t._tpl[i].cloneNode(!0),t._next.style.cssText+=t.getDurationCss(+t.scrollDist+"px",0),t.wrap.appendChild(t._next)},t._delayTime)},"function"==typeof require&&module&&"object"==typeof module&&exports&&"object"==typeof exports?module.exports=i:"function"==typeof define&&define.amd?define(function(){return i}):t.iTrek=t.iTrek||i}(window||this);